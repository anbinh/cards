!function e(t,r,o){function a(n,s){if(!r[n]){if(!t[n]){var l="function"==typeof require&&require;if(!s&&l)return l(n,!0);if(i)return i(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[n]={exports:{}};t[n][0].call(d.exports,function(e){var r=t[n][1][e];return a(r?r:e)},d,d.exports,e,t,r,o)}return r[n].exports}for(var i="function"==typeof require&&require,n=0;n<o.length;n++)a(o[n]);return a}({1:[function(e,t,r){"use strict";e("./services"),e("./filters"),e("./directives"),e("./controllers"),angular.module("app",["ht.services","ht.directives","ht.filters","ht.controllers","ht.templates","ngRoute","ngResource","angular-storage","oitozero.ngSweetAlert","ui.bootstrap","nouislider","credit-cards"])},{"./controllers":2,"./directives":46,"./filters":48,"./services":52}],2:[function(e,t,r){"use strict";var o=angular.module("ht.controllers",[]);e("./lib/home")(o),e("./lib/store-list")(o),e("./lib/sell-cards")(o),e("./lib/sell-cards-card-info")(o),e("./lib/sell-cards-customer-info")(o),e("./lib/sell-cards-receipt")(o),e("./lib/checkout")(o),e("./lib/review_order")(o),e("./lib/login")(o),e("./lib/register")(o),e("./lib/profile")(o),e("./lib/profile-edit")(o),e("./lib/profile-order-list")(o),e("./lib/profile-order-detail")(o),e("./lib/profile-sold-cards-list")(o),e("./lib/profile-sold-cards-details")(o),e("./lib/forget-password")(o),e("./lib/reset-password")(o),e("./lib/shopping-cart")(o),e("./lib/store-detail")(o),e("./lib/header")(o),e("./lib/admin/index")(o),e("./lib/admin/users")(o),e("./lib/admin/guests")(o),e("./lib/admin/dealers")(o),e("./lib/admin/inventory")(o),e("./lib/admin/inventory-retailer")(o),e("./lib/admin/orders")(o),e("./lib/admin/receipts")(o),e("./lib/admin/sidebar")(o),e("./lib/admin/order-detail")(o),e("./lib/admin/receipt-detail")(o),e("./lib/admin/login")(o),e("./lib/admin/head")(o),e("./lib/admin/cards")(o),e("./lib/admin/sold_cards")(o),e("./lib/admin/user-profile")(o),e("./lib/admin/dealer-profile")(o),e("./lib/admin/retailer-limit")(o),e("./lib/admin/pending_cards")(o),e("./lib/admin/settings")(o),e("./lib/admin/transactions")(o),e("./lib/admin/transaction-detail")(o),t.exports=o},{"./lib/admin/cards":3,"./lib/admin/dealer-profile":4,"./lib/admin/dealers":5,"./lib/admin/guests":6,"./lib/admin/head":7,"./lib/admin/index":8,"./lib/admin/inventory":10,"./lib/admin/inventory-retailer":9,"./lib/admin/login":11,"./lib/admin/order-detail":12,"./lib/admin/orders":13,"./lib/admin/pending_cards":14,"./lib/admin/receipt-detail":15,"./lib/admin/receipts":16,"./lib/admin/retailer-limit":17,"./lib/admin/settings":18,"./lib/admin/sidebar":19,"./lib/admin/sold_cards":20,"./lib/admin/transaction-detail":21,"./lib/admin/transactions":22,"./lib/admin/user-profile":23,"./lib/admin/users":24,"./lib/checkout":25,"./lib/forget-password":26,"./lib/header":27,"./lib/home":28,"./lib/login":29,"./lib/profile":35,"./lib/profile-edit":30,"./lib/profile-order-detail":31,"./lib/profile-order-list":32,"./lib/profile-sold-cards-details":33,"./lib/profile-sold-cards-list":34,"./lib/register":36,"./lib/reset-password":37,"./lib/review_order":38,"./lib/sell-cards":42,"./lib/sell-cards-card-info":39,"./lib/sell-cards-customer-info":40,"./lib/sell-cards-receipt":41,"./lib/shopping-cart":43,"./lib/store-detail":44,"./lib/store-list":45}],3:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminCardsController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","cards","all_cards"),e.cards=s,n(function(){$("#datatable-default").dataTable()})})}},{}],4:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminDealerProfileController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),console.log(s),e.user=s,0===e.user.id?(e.user.role="Guest",e.user.className="label-warning"):""===e.user.role||void 0===e.user.role?(e.user.role="Regular User",e.user.className="label-primary"):"user"===e.user.role?(e.user.role="Regular User",e.user.className="label-primary"):"dealer"===e.user.role&&(e.user.role="Dealer",e.user.className="label-success"),e.receiptDetail=function(e){o.url("receipts/"+e)},e.goToOrderDetail=function(e){o.url("orders/"+e)},n(function(){$("#datatable-orders").dataTable(),$("#datatable-receipts").dataTable()})})}},{}],5:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminDealersController",function(e,t,r,o,a,i,n,s,l){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","customers","dealers"),console.log(s),e.dealers=s,e.dealerDeatail=function(e){o.url("dealer-profile/"+e)},n(function(){var e={options:{addButton:"#addToTable",table:"#datatable-default",dialog:{wrapper:"#dialog",cancelButton:"#dialogCancel",confirmButton:"#dialogConfirm"}},initialize:function(){this.setVars().build().events()},setVars:function(){return this.$table=$(this.options.table),this.$addButton=$(this.options.addButton),this.dialog={},this.dialog.$wrapper=$(this.options.dialog.wrapper),this.dialog.$cancel=$(this.options.dialog.cancelButton),this.dialog.$confirm=$(this.options.dialog.confirmButton),this},build:function(){return this.datatable=this.$table.DataTable({}),window.dt=this.datatable,this},events:function(){var e=this;return this.$table.on("click","a.save-row",function(t){t.preventDefault(),e.rowSave($(this).closest("tr"))}).on("click","a.cancel-row",function(t){t.preventDefault(),e.rowCancel($(this).closest("tr"))}).on("click","a.edit-row",function(t){t.preventDefault(),e.rowEdit($(this).closest("tr"))}).on("click","a.remove-row",function(t){t.preventDefault();var r=$(this).closest("tr");$.magnificPopup.open({items:{src:e.options.dialog.wrapper,type:"inline"},preloader:!1,modal:!0,callbacks:{change:function(){e.dialog.$confirm.on("click",function(t){t.preventDefault(),e.rowRemove(r),$.magnificPopup.close()})},close:function(){e.dialog.$confirm.off("click")}}})}),this.$addButton.on("click",function(t){t.preventDefault(),e.rowAdd()}),this.dialog.$cancel.on("click",function(e){e.preventDefault(),$.magnificPopup.close()}),this},rowAdd:function(){this.$addButton.attr({disabled:"disabled"});var e,t,r;e=['<a href="#" class="hidden on-editing save-row"><i class="fa fa-save"></i></a>','<a href="#" class="hidden on-editing cancel-row"><i class="fa fa-times"></i></a>','<a href="#" class="on-default edit-row"><i class="fa fa-pencil"></i></a>','<a href="#" class="on-default remove-row"><i class="fa fa-trash-o"></i></a>'].join(" "),t=this.datatable.row.add(["","","",e]),r=this.datatable.row(t[0]).nodes().to$(),r.addClass("adding").find("td:last").addClass("actions"),this.rowEdit(r),this.datatable.order([0,"asc"]).draw()},rowCancel:function(e){var t,r;e.hasClass("adding")?this.rowRemove(e):(r=this.datatable.row(e.get(0)).data(),this.datatable.row(e.get(0)).data(r),t=e.find("td.actions"),t.get(0)&&this.rowSetActionsDefault(e),this.datatable.draw())},rowEdit:function(e){var t,r=this;t=this.datatable.row(e.get(0)).data(),e.children("td").each(function(o){var a=$(this);a.hasClass("actions")?r.rowSetActionsEditing(e):a.html('<input type="text" class="form-control input-block" value="'+t[o]+'"/>')})},rowSave:function(e){var t,r=this,o=[];e.hasClass("adding")&&(this.$addButton.removeAttr("disabled"),e.removeClass("adding")),o=e.find("td").map(function(){var t=$(this);return t.hasClass("actions")?(r.rowSetActionsDefault(e),r.datatable.cell(this).data()):$.trim(t.find("input").val())}),this.datatable.row(e.get(0)).data(o),t=e.find("td.actions"),t.get(0)&&this.rowSetActionsDefault(e),this.datatable.draw();var a={id:parseInt(o[0]),first_name:o[1],last_name:o[2],email:o[3],address:o[4],city:o[5],state:o[6],dealer_code:o[7],business_name:o[8],business_address:o[9]};l.update({id:a.id},a,function(e){console.log("USER HAS BEEN UPDATED",e)},function(e){swal("Error",e.data.message,"error")})},rowRemove:function(e){e.hasClass("adding")&&this.$addButton.removeAttr("disabled"),this.datatable.row(e.get(0)).remove().draw()},rowSetActionsEditing:function(e){e.find(".on-editing").removeClass("hidden"),e.find(".on-default").addClass("hidden")},rowSetActionsDefault:function(e){e.find(".on-editing").addClass("hidden"),e.find(".on-default").removeClass("hidden")}};e.initialize()})})}},{}],6:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminGuestsController",function(e,t,r,o,a,i,n,s,l){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","customers","guests"),e.users=s,e.type=l,n(function(){$("#datatable-default").dataTable()})})}},{}],7:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminHeadController",function(e,t,r,o,a,i,n){e.logout=function(){r.remove("admin"),window.location="/admin-login/#/"}})}},{}],8:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminIndexController",function(e,t,r,o,a,i,n){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","dashboard",""),e.stats=n,e.range=1,e.currentTab="all",a.dateRanges().$promise.then(function(t){e.dateRanges=t,e.dateRanges.min_date=new Date(e.dateRanges.min_date),e.dateRanges.max_date=new Date(e.dateRanges.max_date);var r=864e5,o=6048e5,a=2592e6,i=e.dateRanges.min_date.getTime(),n=e.dateRanges.max_date.getTime(),s=n-i;e.nDays=Math.round(s/r),e.nWeeks=Math.round(s/o),e.nMonths=Math.round(s/a)}),e.all=function(){e.currentTab="all",e.range=1},e.daily=function(){e.currentTab="daily",e.range=e.nDays},e.weekly=function(){e.currentTab="weekly",e.range=e.nWeeks},e.monthly=function(){e.currentTab="monthly",e.range=e.nMonths},console.log(n,e.dateRanges)})}},{}],9:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminInventoryRetailerController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","inventory",""),e.retailers=s,n(function(){$("#datatable-default").dataTable()})})}},{}],10:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminInventoryController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","inventory",""),e.cards=s,n(function(){$("#datatable-default").dataTable()})})}},{}],11:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminLoginController",function(e,t,r,o,a,i,n){e.login=function(){n.adminLogin(e.user,function(e){r.set("admin",e),window.location="/dashboard/#/"},function(t){swal("Error",t.data.message,"error"),e.user.username="",e.user.password=""})}})}},{}],12:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminOrderDetailController",function(e,t,r,o,a,i,n,s,l){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","cards","orders"),console.log(s),e.order=s,0===e.order.billingUser.id?(e.order.billingUser.role="Guest",e.order.billingUser.className="label-warning"):""===e.order.billingUser.role||void 0===e.order.billingUser.role?(e.order.billingUser.role="Regular User",e.order.billingUser.className="label-primary"):"user"===e.order.billingUser.role&&(e.order.billingUser.role="Regular User",e.order.billingUser.className="label-primary"),n(function(){$("#datatable-default").dataTable()}),e.sendGiftCards=function(){swal({title:"Are you sure?",text:"Do you want to send the gift cards to the email: "+e.order.billingUser.email,type:"warning",showCancelButton:!0,confirmButtonColor:"#47A447",confirmButtonText:"Yes, Send Gift Cards",closeOnConfirm:!0},function(){l.sendGiftCards({id:e.order.id},function(t){"error"===t.status?swal("Error",t.message,"error"):swal("Success","The gift cards have been sent to the email: "+e.order.billingUser.email,"success"),console.log("ORDER SERVICE",t,"success")})})}})}},{}],13:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminOrdersController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","cards","orders"),e.orders=s;for(var l=0;l<e.orders.length;l+=1){0===e.orders[l].billingUser.id?(e.orders[l].billingUser.role="Guest",e.orders[l].billingUser.className="label-warning"):""===e.orders[l].billingUser.role||void 0===e.orders[l].billingUser.role?(e.orders[l].billingUser.role="User",e.orders[l].billingUser.className="label-primary"):"user"===e.orders[l].billingUser.role?(e.orders[l].billingUser.role="User",e.orders[l].billingUser.className="label-primary"):"dealer"===e.orders[l].billingUser.role&&(e.orders[l].billingUser.role="Dealer",e.orders[l].billingUser.className="label-success");for(var c=e.orders[l].cards,d=[],u=0;u<c.length;u+=1)-1===d.indexOf(c[u].name)&&d.push(c[u].name);e.orders[l].storeList=d}console.log("order",e.orders),e.goToOrderDetail=function(e){o.url("orders/"+e)},n(function(){$("#datatable-default").dataTable()})})}},{}],14:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminPendingCardsController",function(e,t,r,o,a,i,n,s,l){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","cards","pending_cards"),e.receipts=s,n(function(){$("#datatable-default").dataTable({paging:!1})});for(var c=0;c<e.receipts.length;c+=1)0===e.receipts[c].billingUser.id?(e.receipts[c].billingUser.role="Guest",e.receipts[c].billingUser.className="label-warning"):""===e.receipts[c].billingUser.role||void 0===e.receipts[c].billingUser.role?(e.receipts[c].billingUser.role="User",e.receipts[c].billingUser.className="label-primary"):"user"===e.receipts[c].billingUser.role?(e.receipts[c].billingUser.role="User",e.receipts[c].billingUser.className="label-primary"):"dealer"===e.receipts[c].billingUser.role&&(e.receipts[c].billingUser.role="Dealer",e.receipts[c].billingUser.className="label-success");e.receiptDetail=function(e){o.url("receipts/"+e)}})}},{}],15:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminReceiptDetailController",function(e,t,r,o,a,i,n,s,l){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","cards","receipts"),console.log(s),e.receipt=s,0===e.receipt.billingUser.id?(e.receipt.billingUser.role="Guest",e.receipt.billingUser.className="label-warning"):""===e.receipt.billingUser.role||void 0===e.receipt.billingUser.role?(e.receipt.billingUser.role="Regular User",e.receipt.billingUser.className="label-primary"):"user"===e.receipt.billingUser.role?(e.receipt.billingUser.role="Regular User",e.receipt.billingUser.className="label-primary"):"dealer"===e.receipt.billingUser.role&&(e.receipt.billingUser.role="Dealer",e.receipt.billingUser.className="label-success"),e.addToInventory=function(){swal({title:"Are you sure?",text:"Do you want to add all these cards to the inventory",type:"warning",showCancelButton:!0,confirmButtonColor:"#47A447",confirmButtonText:"Yes, Add These Cards",closeOnConfirm:!0},function(){"pending"===e.receipt.status&&l.putToInventory({id:e.receipt.id},function(e){"fail"===e.status?swal("Error",e.message,"error"):window.location.reload(!0)})})},n(function(){$("#datatable-default").dataTable()})})}},{}],16:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminReceiptsController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","cards","receipts"),console.log(s),e.receipts=s;for(var l=0;l<e.receipts.length;l+=1)0===e.receipts[l].billingUser.id?(e.receipts[l].billingUser.role="Guest",e.receipts[l].billingUser.className="label-warning"):""===e.receipts[l].billingUser.role||void 0===e.receipts[l].billingUser.role?(e.receipts[l].billingUser.role="User",e.receipts[l].billingUser.className="label-primary"):"user"===e.receipts[l].billingUser.role?(e.receipts[l].billingUser.role="User",e.receipts[l].billingUser.className="label-primary"):"dealer"===e.receipts[l].billingUser.role&&(e.receipts[l].billingUser.role="Dealer",e.receipts[l].billingUser.className="label-success");e.receiptDetail=function(e){o.url("receipts/"+e)},n(function(){$("#datatable-default").dataTable()})})}},{}],17:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminRetailerLimitController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","retailer-limits",""),e.retailers=s,n(function(){var t={options:{addButton:"#addToTable",table:"#datatable-default",dialog:{wrapper:"#dialog",cancelButton:"#dialogCancel",confirmButton:"#dialogConfirm"}},initialize:function(){this.setVars().build().events()},setVars:function(){return this.$table=$(this.options.table),this.$addButton=$(this.options.addButton),this.dialog={},this.dialog.$wrapper=$(this.options.dialog.wrapper),this.dialog.$cancel=$(this.options.dialog.cancelButton),this.dialog.$confirm=$(this.options.dialog.confirmButton),this},build:function(){return this.datatable=this.$table.DataTable({paging:!1}),window.dt=this.datatable,this},events:function(){var e=this;return this.$table.on("click","a.save-row",function(t){t.preventDefault(),e.rowSave($(this).closest("tr"))}).on("click","a.cancel-row",function(t){t.preventDefault(),e.rowCancel($(this).closest("tr"))}).on("click","a.edit-row",function(t){t.preventDefault(),e.rowEdit($(this).closest("tr"))}).on("click","a.remove-row",function(t){t.preventDefault();var r=$(this).closest("tr");$.magnificPopup.open({items:{src:e.options.dialog.wrapper,type:"inline"},preloader:!1,modal:!0,callbacks:{change:function(){e.dialog.$confirm.on("click",function(t){t.preventDefault(),e.rowRemove(r),$.magnificPopup.close()})},close:function(){e.dialog.$confirm.off("click")}}})}),this.$addButton.on("click",function(t){t.preventDefault(),e.rowAdd()}),this.dialog.$cancel.on("click",function(e){e.preventDefault(),$.magnificPopup.close()}),this},rowAdd:function(){this.$addButton.attr({disabled:"disabled"});var e,t,r;e=['<a href="#" class="hidden on-editing save-row"><i class="fa fa-save"></i></a>','<a href="#" class="hidden on-editing cancel-row"><i class="fa fa-times"></i></a>','<a href="#" class="on-default edit-row"><i class="fa fa-pencil"></i></a>','<a href="#" class="on-default remove-row"><i class="fa fa-trash-o"></i></a>'].join(" "),t=this.datatable.row.add(["","","",e]),r=this.datatable.row(t[0]).nodes().to$(),r.addClass("adding").find("td:last").addClass("actions"),this.rowEdit(r),this.datatable.order([0,"asc"]).draw()},rowCancel:function(e){var t,r;e.hasClass("adding")?this.rowRemove(e):(r=this.datatable.row(e.get(0)).data(),this.datatable.row(e.get(0)).data(r),t=e.find("td.actions"),t.get(0)&&this.rowSetActionsDefault(e),this.datatable.draw())},rowEdit:function(e){var t,r=this;t=this.datatable.row(e.get(0)).data(),e.children("td").each(function(o){var a=$(this);a.hasClass("actions")?r.rowSetActionsEditing(e):a.html('<input type="text" class="form-control input-block" value="'+t[o]+'"/>')})},rowSave:function(t){var r,o=this,i=[];t.hasClass("adding")&&(this.$addButton.removeAttr("disabled"),t.removeClass("adding")),i=t.find("td").map(function(){var e=$(this);return e.hasClass("actions")?(o.rowSetActionsDefault(t),o.datatable.cell(this).data()):$.trim(e.find("input").val())});var n={id:parseInt(i[0]),name:i[2],limit:parseInt(i[3]),inventory:parseInt(i[4]),retailer_id:parseInt(i[5])};n.limit<n.inventory?swal("Error","You cannot update the limit. The limit has to be greater than the number of cards in current inventory","error"):(this.datatable.row(t.get(0)).data(i),r=t.find("td.actions"),r.get(0)&&this.rowSetActionsDefault(t),this.datatable.draw(),a.update({id:n.id},n,function(t){console.log("STORE HAS BEEN UPDATED",t);for(var r=0;r<e.retailers.length;r+=1)e.retailers[r].id===t.id&&(e.retailers[r].limit=t.limit)},function(e){swal("Error",e.data.message,"error")})),console.log("data posted",n)},rowRemove:function(e){e.hasClass("adding")&&this.$addButton.removeAttr("disabled"),this.datatable.row(e.get(0)).remove().draw()},rowSetActionsEditing:function(e){e.find(".on-editing").removeClass("hidden"),e.find(".on-default").addClass("hidden")},rowSetActionsDefault:function(e){e.find(".on-editing").addClass("hidden"),e.find(".on-default").removeClass("hidden")}};t.initialize()})})}},{}],18:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminSettingsController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","settings",""),e.settings=s,n(function(){var e={options:{addButton:"#addToTable",table:"#datatable-default",dialog:{wrapper:"#dialog",cancelButton:"#dialogCancel",confirmButton:"#dialogConfirm"}},initialize:function(){this.setVars().build().events()},setVars:function(){return this.$table=$(this.options.table),this.$addButton=$(this.options.addButton),this.dialog={},this.dialog.$wrapper=$(this.options.dialog.wrapper),this.dialog.$cancel=$(this.options.dialog.cancelButton),this.dialog.$confirm=$(this.options.dialog.confirmButton),this},build:function(){return this.datatable=this.$table.DataTable({paging:!1}),window.dt=this.datatable,this},events:function(){var e=this;return this.$table.on("click","a.save-row",function(t){t.preventDefault(),e.rowSave($(this).closest("tr"))}).on("click","a.cancel-row",function(t){t.preventDefault(),e.rowCancel($(this).closest("tr"))}).on("click","a.edit-row",function(t){t.preventDefault(),e.rowEdit($(this).closest("tr"))}).on("click","a.remove-row",function(t){t.preventDefault();var r=$(this).closest("tr");$.magnificPopup.open({items:{src:e.options.dialog.wrapper,type:"inline"},preloader:!1,modal:!0,callbacks:{change:function(){e.dialog.$confirm.on("click",function(t){t.preventDefault(),e.rowRemove(r),$.magnificPopup.close()})},close:function(){e.dialog.$confirm.off("click")}}})}),this.$addButton.on("click",function(t){t.preventDefault(),e.rowAdd()}),this.dialog.$cancel.on("click",function(e){e.preventDefault(),$.magnificPopup.close()}),this},rowAdd:function(){this.$addButton.attr({disabled:"disabled"});var e,t,r;e=['<a href="#" class="hidden on-editing save-row"><i class="fa fa-save"></i></a>','<a href="#" class="hidden on-editing cancel-row"><i class="fa fa-times"></i></a>','<a href="#" class="on-default edit-row"><i class="fa fa-pencil"></i></a>','<a href="#" class="on-default remove-row"><i class="fa fa-trash-o"></i></a>'].join(" "),t=this.datatable.row.add(["","","",e]),r=this.datatable.row(t[0]).nodes().to$(),r.addClass("adding").find("td:last").addClass("actions"),this.rowEdit(r),this.datatable.order([0,"asc"]).draw()},rowCancel:function(e){var t,r;e.hasClass("adding")?this.rowRemove(e):(r=this.datatable.row(e.get(0)).data(),this.datatable.row(e.get(0)).data(r),t=e.find("td.actions"),t.get(0)&&this.rowSetActionsDefault(e),this.datatable.draw())},rowEdit:function(e){var t,r=this;t=this.datatable.row(e.get(0)).data(),e.children("td").each(function(o){var a=$(this);a.hasClass("actions")?r.rowSetActionsEditing(e):a.html('<input type="text" class="form-control input-block" value="'+t[o]+'"/>')})},rowSave:function(e){var t,r=this,o=[];e.hasClass("adding")&&(this.$addButton.removeAttr("disabled"),e.removeClass("adding")),o=e.find("td").map(function(){var t=$(this);return t.hasClass("actions")?(r.rowSetActionsDefault(e),r.datatable.cell(this).data()):$.trim(t.find("input").val())});var i={id:parseInt(o[0]),value:o[2],description:o[3]};console.log("update",i),this.datatable.row(e.get(0)).data(o),t=e.find("td.actions"),t.get(0)&&this.rowSetActionsDefault(e),this.datatable.draw(),a.update({id:i.id},i,function(e){console.log("SETTING HAS BEEN UPDATED",e)},function(e){swal("Error",e.data.message,"error")})},rowRemove:function(e){e.hasClass("adding")&&this.$addButton.removeAttr("disabled"),this.datatable.row(e.get(0)).remove().draw()},rowSetActionsEditing:function(e){e.find(".on-editing").removeClass("hidden"),e.find(".on-default").addClass("hidden")},rowSetActionsDefault:function(e){e.find(".on-editing").addClass("hidden"),e.find(".on-default").removeClass("hidden")}};e.initialize()})})}},{}],19:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminSideBarController",function(e,t,r,o,a,i){i.adminAuthenticate(),e.currentActiveParent="dashboard",e.currentActiveChild="",t.$on("CHANGE_SIDEBAR_ITEM",function(t,r,o){console.log("parent child",r,o),e.currentActiveParent=r,e.currentActiveChild=o}),e.popularBought=a.popularBought(),e.popularSold=a.popularSold(),e.average=a.average()})}},{}],20:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminSoldCardsController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","cards","sold_cards"),e.cards=s;for(var l=0;l<e.cards.length;l+=1){var c=e.cards[l].gogo_buy,d=e.cards[l].purchase.save;e.cards[l].spread=(100-c-d)/(100-d)*100}n(function(){$("#datatable-default").dataTable()})})}},{}],21:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminTransactionDetailController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","transactions",""),console.log(s),e.transaction=s,0===e.transaction.billingUser.id?(e.transaction.billingUser.role="Guest",e.transaction.billingUser.className="label-warning"):""===e.transaction.billingUser.role||void 0===e.transaction.billingUser.role?(e.transaction.billingUser.role="Regular User",e.transaction.billingUser.className="label-primary"):"user"===e.transaction.billingUser.role?(e.transaction.billingUser.role="Regular User",e.transaction.billingUser.className="label-primary"):"dealer"===e.transaction.billingUser.role&&(e.transaction.billingUser.role="Dealer",e.transaction.billingUser.className="label-success"),n(function(){$("#datatable-default").dataTable()})})}},{}],22:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminTransactionsController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","transactions",""),e.transactions=s;for(var l=0;l<e.transactions.length;l+=1)0===e.transactions[l].billingUser.id?(e.transactions[l].billingUser.role="Guest",e.transactions[l].billingUser.className="label-warning"):""===e.transactions[l].billingUser.role||void 0===e.transactions[l].billingUser.role?(e.transactions[l].billingUser.role="User",e.transactions[l].billingUser.className="label-primary"):"user"===e.transactions[l].billingUser.role?(e.transactions[l].billingUser.role="User",e.transactions[l].billingUser.className="label-primary"):"dealer"===e.transactions[l].billingUser.role&&(e.transactions[l].billingUser.role="Dealer",e.transactions[l].billingUser.className="label-success");e.transactionDetail=function(e){o.url("transactions/"+e)},n(function(){$("#datatable-default").dataTable()})})}},{}],23:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminUserProfileController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),console.log(s),e.user=s,0===e.user.id?(e.user.role="Guest",e.user.className="label-warning"):""===e.user.role||void 0===e.user.role?(e.user.role="Regular User",e.user.className="label-primary"):"user"===e.user.role?(e.user.role="Regular User",e.user.className="label-primary"):"dealer"===e.user.role&&(e.user.role="Dealer",e.user.className="label-success"),e.receiptDetail=function(e){o.url("receipts/"+e)},e.goToOrderDetail=function(e){o.url("orders/"+e)},n(function(){$("#datatable-orders").dataTable(),$("#datatable-receipts").dataTable()})})}},{}],24:[function(e,t,r){"use strict";t.exports=function(e){e.controller("AdminUsersController",function(e,t,r,o,a,i,n,s){i.adminAuthenticate(),t.$broadcast("CHANGE_SIDEBAR_ITEM","customers","users"),console.log(s),e.users=s,e.userProfile=function(e){o.url("user-profile/"+e)},n(function(){$("#datatable-default").dataTable()})})}},{}],25:[function(e,t,r){"use strict";t.exports=function(e){e.controller("CheckoutController",["$scope","$location","$routeParams","authService","store",function(e,t,r,o,a){e.selectedCards=a.get("cart"),o.isAuthenticated()?(e.isGuest=!1,e.user=a.get("user")):(e.isGuest=!0,e.user={id:0}),e.payment={name:"cc_terminal"};for(var i=0,n=0,s=0,l=0;l<e.selectedCards.length;l+=1){var c=e.selectedCards[l];i+=c.pay,n+=c.value,s+=c.pay/c.value*100}e.total=i,e.totalFaceValue=n,e.averagePercentage=100-s/e.selectedCards.length,e.placeOrder=function(t){if(e.agreed===!1)return void swal("Warning","You have to agree the terms and conditions","warnning");var r={billingUser:e.user,cards:e.selectedCards,payment:e.payment.name};return"ach"===e.payment.name?void swal("Error","No payment support","error"):t.cardNumber.$valid===!1?void swal("Error","The card number is not valid","error"):(console.log("payment",e.payment.name),a.set("order",r),void(window.location="/checkout/#/review_order"))}}])}},{}],26:[function(e,t,r){"use strict";t.exports=function(e){e.controller("ForgetPasswordController",["$scope","$location","$routeParams","authService","store","userService",function(e,t,r,o,a,i){e.forgetPassword=function(){i.forgetPassword({email:e.email},function(t){console.log(t),e.email="",swal({title:"Done",text:"An email to reset your password has been sent to your email",type:"success",showCancelButton:!0,confirmButtonText:"Go To Homepage",closeOnConfirm:!1,confirmButtonColor:"#08C"},function(){window.location="/"})},function(e){swal("Error",e.data.message,"error")})}}])}},{}],27:[function(e,t,r){"use strict";t.exports=function(e){e.controller("HeaderController",["$scope","$rootScope","store","$location","authService","$routeParams","storeService",function(e,t,r,o,a,i,n){function s(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}console.log("HEADER Route PARAM",i);var l,c,d=function(e){for(var t=0,r=e.length-1;r>=0;r-=1)t+=e[r].pay;return Math.round(100*t)/100};n.get().$promise.then(function(t){e.allStores=t;for(var r=0;r<e.allStores.length;r+=1)e.allStores[r].originalName=e.allStores[r].name,e.allStores[r].name=s(e.allStores[r].name.split("-").join(" "))}),e.loggedIn=a.isAuthenticated()?!0:!1,e.showCheckout=!1,e.selectedCards=[];var u=r.get("cart");u&&(console.log(u),e.selectedCards=u,l=d(e.selectedCards),c=e.selectedCards.length,e.cartStat="Cart ("+c+") - $ "+l,c>0&&(e.showCheckout=!0)),t.$on("CHANGE_CART",function(){e.selectedCards=r.get("cart"),l=d(e.selectedCards),c=e.selectedCards.length,e.cartStat="Cart ("+c+") - $"+l,c>0&&(e.showCheckout=!0)}),e.removeCard=function(t){var o=r.get("cart");o.splice(t,1),r.set("cart",o),e.selectedCards=r.get("cart"),l=d(e.selectedCards),c=e.selectedCards.length,e.cartStat="Cart ("+c+") - $"+l},e.viewShoppingCart=function(){window.location="/shopping-cart/#/"},e.checkout=function(){var e=btoa(window.location.origin+"/checkout"),t="/login/#/?forward_url="+e;r.get("user")?window.location="/checkout":swal({title:"Notice",text:'You can login before going to the next step <a href="'+t+'">LOGIN NOW</a>  </br> Or you can continue to use the site as a guest',type:"warning",showCancelButton:!0,confirmButtonText:"Continue as guest",closeOnConfirm:!1,confirmButtonColor:"#08C",html:!0},function(){window.location=window.location.origin+"/checkout/#/?guest=true",swal.close()})},e.signOut=function(){r.remove("user"),window.location="/"},e.searchStore=function(){e.searchedStore.originalName?window.location="/stores/#/"+e.searchedStore.originalName:swal("Invalid Store","The store you are looking is not available","error")}}])}},{}],28:[function(e,t,r){"use strict";t.exports=function(e){e.controller("HomeController",function(e,t,r,o,a){e.auth=a.auth(),console.log("HOME CONTROLLER",o),e.featuredstoreService=o.featured(),e.highestPayouts=o.highestPayout(),e.login=function(){},e.logout=function(){},e.search=function(){window.location="/search/#/?q="+e.query},e.go=function(e){window.location=e}})}},{}],29:[function(e,t,r){"use strict";t.exports=function(e){e.controller("LoginController",["$scope","$location","$routeParams","authService","store","userService","isDealer",function(e,t,r,o,a,i,n){console.log("LOGIN",r),e.isDealer=n,e.login=function(){i.login(e.user,function(e){console.log(e),a.set("user",e),""!==r.forward_url&&void 0!==r.forward_url?(console.log("$routeParams.forward_url",atob(r.forward_url)),window.location=atob(r.forward_url)):window.location="/profile/"},function(e){swal("Error",e.data.message,"error")})}}])}},{}],30:[function(e,t,r){"use strict";t.exports=function(e){e.controller("ProfileEditController",["$scope","$location","$routeParams","authService","store","userService",function(e,t,r,o,a,i){o.isAuthenticated()||(window.location="/unauthorized/"),e.user=a.get("user"),
console.log(e.user,"edit user"),e.update=function(t){return console.log("user",e.user),console.log("payment",t),t.cardNumber.$valid===!1?void swal("Error","The card number is not valid","error"):void i.update({id:e.user.id},e.user,function(e){console.log("USER HAS BEEN UPDATED",e),a.set("user",e),window.location="/profile/"},function(e){swal("Error",e.data.message,"error")})}}])}},{}],31:[function(e,t,r){"use strict";t.exports=function(e){e.controller("ProfileOrderDetailController",["$scope","$location","$routeParams","authService","store","userService","orderService",function(e,t,r,o,a,i,n){o.isAuthenticated()||(window.location="/unauthorized/"),e.order=n.get({id:r.id},function(t){for(var r=0,o=0,a=0,i=0;i<e.order.cards.length;i+=1){var n=e.order.cards[i];r+=n.pay,o+=n.value,a+=n.pay/n.value*100}e.total=r,e.totalFaceValue=o,e.averagePercentage=100-a/e.order.cards.length})}])}},{}],32:[function(e,t,r){"use strict";t.exports=function(e){e.controller("ProfileOrderListController",["$scope","$location","$routeParams","authService","store","userService",function(e,t,r,o,a,i){o.isAuthenticated()||(window.location="/unauthorized/");var n=a.get("user");e.orders=i.getOrdersByUserId({id:n.id},function(e){},function(e){swal("Error",e.data.message,"error")}),e.orderDetail=function(e){window.location="/profile/#/orders/"+e}}])}},{}],33:[function(e,t,r){"use strict";t.exports=function(e){e.controller("SoldCardDetailController",["$scope","$location","$routeParams","authService","store","userService","SoldCardList",function(e,t,r,o,a,i,n){o.isAuthenticated()?e.user=a.get("user"):window.location="/",e.isDealer="dealer"===e.user.role?!0:!1,e.sellingCards=n,e.total=e.sellingCards.total_amount,e.totalFaceValue=e.sellingCards.total_face_value,e.averagePayout=e.sellingCards.average_payout}])}},{}],34:[function(e,t,r){"use strict";t.exports=function(e){e.controller("SoldCardListListController",["$scope","$location","$routeParams","authService","store","userService","SoldCardsList",function(e,t,r,o,a,i,n){o.isAuthenticated()||(window.location="/unauthorized/"),e.soldCardsList=n,e.soldCardsDetail=function(e){window.location="/profile/#/sold-cards/"+e};for(var s=0;s<e.soldCardsList.length;s+=1){var l=[],c=e.soldCardsList[s].store_list.split(",");console.log("store",c);for(var d=0;d<c.length;d+=1)l.push({image:c[s],text:""});e.soldCardsList[s].slides=l}}])}},{}],35:[function(e,t,r){"use strict";t.exports=function(e){e.controller("ProfileController",["$scope","$location","$routeParams","authService","store","userService",function(e,t,r,o,a,i){o.isAuthenticated()||(window.location="/unauthorized/"),e.user=a.get("user"),e.isDealer="dealer"===e.user.role?!0:!1}])}},{}],36:[function(e,t,r){"use strict";t.exports=function(e){e.controller("RegisterController",["$scope","$location","$routeParams","authService","store","userService","isDealer",function(e,t,r,o,a,i,n){e.isDealer=n,e.signUp=function(){console.log("NEW USER",e.user);var t=angular.copy(e.user),r=i;if(t.password!==t.password2)return void swal("Error!","Your password does not match","error");delete t.password2,n===!0&&(t.role="dealer");var o=new r(t);o.$save(function(e){a.set("user",e),window.location="/profile"},function(e){swal("Error",e.data.message,"error")})}}])}},{}],37:[function(e,t,r){"use strict";t.exports=function(e){e.controller("ResetPasswordController",["$scope","$location","$routeParams","authService","store","userService",function(e,t,r,o,a,i){e.resetPassword=function(){return e.password!==e.password2?void swal("Error!","Your password does not match","error"):void i.resetPassword({token:r.token,password:e.password},function(t){console.log(t),e.password="",e.password2="",swal({title:"Done",text:"Your password has been reset",type:"success",showCancelButton:!0,confirmButtonText:"Login",closeOnConfirm:!1,confirmButtonColor:"#08C"},function(){window.location="/login/"})},function(e){swal("Error",e.data.message,"error")})}}])}},{}],38:[function(e,t,r){"use strict";t.exports=function(e){e.controller("ReviewOrderController",["$scope","$location","$routeParams","authService","store","userService","$rootScope",function(e,t,r,o,a,i,n){if(o.isAuthenticated()?(e.isGuest=!1,e.user=a.get("user")):(e.isGuest=!0,e.user={id:0}),e.isPaid=!1,e.order=a.get("order"),e.order&&void 0===e.order.cards)return alert("invalid page"),void(window.location="/");console.log("order",e.order);for(var s=0,l=0,c=0,d=0;d<e.order.cards.length;d+=1){var u=e.order.cards[d];s+=u.pay,l+=u.value,c+=u.pay/u.value*100}e.total=s,e.totalFaceValue=l,e.averagePercentage=100-c/e.order.cards.length,e.pay=function(){var t={user_id:e.user.id,billing_user:e.order.billingUser,cards:e.order.cards,total_amount:s,total_cards:e.order.cards.length,total_face_value:e.totalFaceValue,average_percentage:e.averagePercentage,payment:e.order.payment};console.log("order",t),e.isPaid=!0,i.pay(t,function(t){console.log("PAYMENT",t),a.set("cart",[]),a.set("order",{}),e.isGuest?(swal({title:"Congratulations!",text:"Your Order has been paid!",type:"success",showCancelButton:!1,confirmButtonText:"Ok, Go To Homepage!",closeOnConfirm:!1,closeOnCancel:!1},function(){window.location="/"}),n.$broadcast("CHANGE_CART",{})):swal({title:"Congratulations!",text:"Your Order has been paid!",type:"success",showCancelButton:!1,confirmButtonText:"Ok, view order!",closeOnConfirm:!1,closeOnCancel:!1},function(){window.location="/profile/#/orders/"+t.id})},function(e){console.log("ERRR",e),a.set("cart",[]),a.set("order",{}),window.location="/payment-declined"})}}])}},{}],39:[function(e,t,r){"use strict";t.exports=function(e){e.controller("SellCardInfoController",["$scope","$location","$routeParams","authService","store","userService","cardService",function(e,t,r,o,a,i,n){if(e.ENTER_ONLINE_DISCOUNT=.0575,e.user=a.get("user"),e.user&&"dealer"===e.user.role?(e.isDealer=!0,e.dealerCode=e.user.dealer_code):e.isDealer=!1,a.get("selling_cards"))e.allSellingCards=a.get("selling_cards");else{var s=[];e.stores=a.get("selling_stores");for(var l=0;l<e.stores.length;l+=1){var c,d=e.stores[l];c="mail"===d.payBy?1:1-e.ENTER_ONLINE_DISCOUNT,console.log("current store",d);for(var u=0;u<d.amount;u+=1){var f=d.gogo_buy*d.value/100,g={gogo_buy:d.gogo_buy,store_name:d.originalName,store_id:d.id,value:d.value,amount:1,pay_by:d.payBy,bought_value:f*c,payout:f*c/d.value*100,retailer_id:d.retailer_id};s.push(g)}}e.allSellingCards=s}e.isDealer===!0&&(null===e.user.dealer_code||void 0===e.user.dealer_code||""===e.user.dealer_code)&&swal({title:"Dealer Code Missing!",text:'Missing Delear code for your dealer account. Please contact admin to get the code. <a href="mailto:admin@cardslyce.com?Subject=Need%20A%20Dealer%20Code" target="_top">Request A Dealer Code Now!</a>',type:"error",showCancelButton:!1,confirmButtonText:"Ok",closeOnConfirm:!1,closeOnCancel:!1,animation:"slide-from-top",html:!0});for(var p=0;p<e.allSellingCards.length;p+=1)e.allSellingCards[p].status="unchecked";console.log("selling stores xxx",a.get("selling_cards")),e.goBack=function(){t.url("")},e.goNext=function(){if(console.log("current selling cards",e.allSellingCards),e.isDealer===!0){for(var t=!1,r=0;r<e.allSellingCards.length;r+=1)e.allSellingCards[r].dealer_code!==e.user.dealer_code&&(t=!0);if(t===!0&&e.isDealer===!0)return void swal({title:"Dealer Code Not Match!",text:'Dealer Code does not match. Please contact admin to get the code. <a href="mailto:admin@cardslyce.com?Subject=Need%20A%20Dealer%20Code" target="_top">Request A Dealer Code Now!</a>',type:"error",showCancelButton:!1,confirmButtonText:"Ok",closeOnConfirm:!1,closeOnCancel:!1,animation:"slide-from-top",html:!0})}a.set("selling_cards",angular.copy(e.allSellingCards));var o=btoa(window.location.origin+"/sell-cards/#/customer-info"),i="/login/#/?forward_url="+o;a.get("user")?window.location=window.location.origin+"/sell-cards/#/customer-info":swal({title:"Notice",text:'You can login before going to the next step <a href="'+i+'">LOGIN NOW</a>  </br> Or you can continue to use the site as a guest',type:"warning",showCancelButton:!0,confirmButtonText:"Continue as guest",closeOnConfirm:!1,confirmButtonColor:"#08C",html:!0},function(){window.location=window.location.origin+"/sell-cards/#/customer-info?guest=true",swal.close()})}}])}},{}],40:[function(e,t,r){"use strict";t.exports=function(e){e.controller("SellCardCustomerInfoController",["$scope","$location","$routeParams","authService","store","userService","utilService","storeList",function(e,t,r,o,a,i,n,s){var l,c;e.ENTER_ONLINE_DISCOUNT=.0575,"true"===r.guest?(e.isGuest=!0,l={id:0}):e.isGuest=!1,e.user=a.get("user"),e.isDealer=e.user&&"dealer"===e.user.role?!0:!1,c=a.get("selling_cards");for(var d={},u=0;u<s.length;u+=1)d[s[u].id]=s[u].limit-s[u].inventory;for(e.hasPendingCards=!1,e.hasValidCards=!1,u=0;u<c.length;u+=1)"mail"===c[u].pay_by?(c[u].status="pending",e.hasPendingCards=!0):d[c[u].store_id]>0?(c[u].status="ok",d[c[u].store_id]-=1,e.hasValidCards=!0):(c[u].status="pending",e.hasPendingCards=!0);var f=[],g=[];for(u=0;u<c.length;u+=1)"ok"===c[u].status&&f.push(c[u]),"pending"===c[u].status&&g.push(c[u]);if(e.sellingCards={billingUser:e.isGuest?l:a.get("user"),cards:[]},e.hasValidCards===!0&&(e.sellingCards={billingUser:e.isGuest?l:a.get("user"),cards:f},console.log("selling cards",e.sellingCards),e.subtractAmount="mail"===e.sellingCards.cards[0].pay_by?0:5,console.log("PAYBY:",e.sellingCards.cards[0].pay_by),e.total="mail"===e.sellingCards.cards[0].pay_by?n.totalOfferMailCard(e.sellingCards.cards):n.totalOfferOnline(e.sellingCards.cards),e.totalFaceValue=n.totalFaceValue(e.sellingCards.cards),e.averagePayout=e.total/e.totalFaceValue*100),e.hasPendingCards===!0&&(e.pendingCards={billingUser:e.isGuest?l:a.get("user"),cards:g},e.subtractAmount="mail"===e.pendingCards.cards[0].pay_by?0:5,e.pendingTotal="mail"===e.pendingCards.cards[0].pay_by?n.totalOfferMailCard(e.pendingCards.cards):n.totalOfferOnline(e.pendingCards.cards),e.pendingTotalFaceValue=n.totalFaceValue(e.pendingCards.cards),e.pendingAveragePayout=e.pendingTotal/e.pendingTotalFaceValue*100),!e.isGuest){var p=a.get("user");e.emptyCC=null!==p.card_number&&null!==p.card_name&&null!==p.card_exp_month&&null!==p.card_exp_year&&null!==p.card_cvc?!1:!0}e.isLoading=!1,e.sellCards=function(r){var o,n,s,c;if(e.agreed===!1)return void swal("Warning","You have to agree the terms and conditions","warnning");if(e.isGuest&&r.cardNumber.$valid===!1)return void swal("Error","The card number is not valid","error");if(e.hasValidCards===!0){if(o=e.isGuest?l:a.get("user"),n=e.sellingCards.billingUser,e.isGuest===!0){if(n.email!==n.email2)return void swal("Error!","Email does not match","error");if(n.password!==n.password2)return void swal("Error!","Password does not match","error");n.username=n.first_name+" "+n.last_name}for(s=[],c=0;c<e.sellingCards.cards.length;c+=1){var d=e.sellingCards.cards[c];-1===s.indexOf(d.store_name)&&s.push(d.store_name)}var u={user_id:o.id,billing_user:e.isGuest?n:a.get("user"),cards:e.sellingCards.cards,total_amount:e.total,total_cards:e.sellingCards.cards.length,total_face_value:e.totalFaceValue,average_payout:e.averagePayout,store_list:s.join(","),payment:e.sellingCards.cards[0].pay_by,status:"ok"};console.log("YOUR SELLING CARDS",u),swal({title:"Notice",text:"The amount may be changed because we will verify the card balance. Please see the email verification",type:"info",showCancelButton:!0,confirmButtonText:"I agree",closeOnConfirm:!1,confirmButtonColor:"#08C",html:!0},function(){swal.close(),e.isLoading=!0,e.$apply(),i.sellCards(u,function(r){console.log(r),a.set("selling_cards",[]),a.set("selling_stores",[]),t.url(e.isGuest?"receipt/"+r.id+"?guest=true":"receipt/"+r.id),console.log("RECEIPT",r)},function(e){console.log("ERRR",e),window.location="/payment-declined"})})}if(e.hasPendingCards===!0){if(o=e.isGuest?l:a.get("user"),n=e.sellingCards.billingUser,e.isGuest===!0){if(n.email!==n.email2)return void swal("Error!","Email does not match","error");if(n.password!==n.password2)return void swal("Error!","Password does not match","error");n.username=n.first_name+" "+n.last_name}for(s=[],c=0;c<e.pendingCards.cards.length;c+=1){var f=e.pendingCards.cards[c];-1===s.indexOf(f.store_name)&&s.push(f.store_name)}var g={user_id:o.id,billing_user:e.isGuest?n:a.get("user"),cards:e.pendingCards.cards,total_amount:e.pendingTotal,total_cards:e.pendingCards.cards.length,total_face_value:e.pendingTotalFaceValue,average_payout:e.pendingAveragePayout,store_list:s.join(","),payment:e.pendingCards.cards[0].pay_by,status:"pending"};console.log("YOUR PENDING CARDS",g),swal({title:"Notice",text:"The amount may be changed because we will verify the card balance. Please see the email verification",type:"info",showCancelButton:!0,confirmButtonText:"I agree",closeOnConfirm:!1,confirmButtonColor:"#08C",html:!0},function(){swal.close(),e.isLoading=!0,e.$apply(),i.sellCards(g,function(r){console.log(r),console.log("PENDING RECEIPT",r),e.hasValidCards===!1&&(a.set("selling_cards",[]),a.set("selling_stores",[]),t.url(e.isGuest?"receipt/"+r.id+"?guest=true":"receipt/"+r.id))},function(e){window.location="/payment-declined"})})}}}])}},{}],41:[function(e,t,r){"use strict";t.exports=function(e){e.controller("SellCardReceiptController",["$scope","$location","$routeParams","authService","store","userService","SellingCardList","utilService",function(e,t,r,o,a,i,n,s){var l;"true"===r.guest?(e.isGuest=!0,l={id:0}):e.isGuest=!1,e.sellingCards=n,e.total=e.sellingCards.total_amount,e.totalFaceValue=e.sellingCards.total_face_value,e.averagePayout=e.sellingCards.average_payout,e.viewSellingHistory=function(){window.location="/profile/#/sold-cards-history"}}])}},{}],42:[function(e,t,r){"use strict";t.exports=function(e){e.controller("SellCardController",["$scope","$location","$routeParams","authService","store","userService","storeList","utilService",function(e,t,r,o,a,i,n,s){e.ENTER_ONLINE_DISCOUNT=.0575,console.log("util service",s),e.payBy={mail:!0,online:!1},e.store={balance:null,amount:1,brand:null},a.remove("selling_cards"),e.storeSelected=void 0,e.allStores=n;for(var l=0;l<e.allStores.length;l+=1)e.allStores[l].originalName=e.allStores[l].name,e.allStores[l].name=s.titleCase(e.allStores[l].name.split("-").join(" "));e.$watch("payBy.mail",function(){e.payBy.mail===!0&&(e.payBy.online=!1)}),e.$watch("payBy.online",function(){e.payBy.online===!0&&(e.payBy.mail=!1)}),e.goToCardInfo=function(){t.url("/card-info")},null===a.get("selling_stores")||0===a.get("selling_stores").length?(e.showIntruction=!0,a.set("selling_stores",[])):(e.showIntruction=!1,e.stores=a.get("selling_stores"),e.totalOfferMailCard=s.totalOfferMailCard(e.stores),e.totalOfferOnline=s.totalOfferOnline(e.stores),"mail"===e.stores[0].payBy?(e.payBy.mail=!0,e.payBy.online=!1):(e.payBy.mail=!1,e.payBy.online=!0)),console.log("SELLING STORES",a.get("selling_stores")),e.addStore=function(){if(!e.store.brand.originalName)return e.store={balance:null,amount:1,brand:null},void swal("Invalid Store","The store you entered is not valid","error");if(void 0===e.store.balance||null===e.store.balance)return void swal("Invalid Balance","Please enter the card balance","error");if(void 0===e.store.amount||null===e.store.amount)return void swal("Invalid Quantity","Please enter the quantity number","error");a.remove("selling_cards"),console.log("store",e.store),e.showIntruction=!1;var t=a.get("selling_stores"),r={value:parseInt(e.store.balance),amount:parseInt(e.store.amount),gogo_buy:e.store.brand.gogo_buy,name:e.store.brand.name,originalName:e.store.brand.originalName,id:e.store.brand.id,payBy:e.payBy.mail===!0?"mail":"online",retailer_id:e.store.brand.retailer_id};e.store={balance:null,amount:1,brand:null},t.push(r),e.totalOfferMailCard=s.totalOfferMailCard(t),e.totalOfferOnline=s.totalOfferOnline(t),e.stores=t,a.set("selling_stores",t),console.log("current store",r)},e.removeStore=function(t){a.remove("selling_cards"),e.stores.splice(t,1),a.set("selling_stores",e.stores),e.totalOfferMailCard=s.totalOfferMailCard(e.stores),e.totalOfferOnline=s.totalOfferOnline(e.stores)},e.mailBoxCLick=function(){if(e.payBy.mail===!1){e.payBy.mail=!e.payBy.mail;for(var t=a.get("selling_stores"),r=0;r<t.length;r+=1)t[r].payBy="mail";a.set("selling_stores",t)}},e.onlineBoxCLick=function(){if(e.payBy.online===!1){e.payBy.online=!e.payBy.online;for(var t=a.get("selling_stores"),r=0;r<t.length;r+=1)t[r].payBy="online";a.set("selling_stores",t)}}}])}},{}],43:[function(e,t,r){"use strict";t.exports=function(e){e.controller("ShoppingCartController",["$scope","$location","$routeParams","authService","store","$rootScope",function(e,t,r,o,a,i){var n=function(e){for(var t=0,r=e.length-1;r>=0;r-=1)t+=e[r].pay;return Math.round(100*t)/100};e.selectedCards=a.get("cart");for(var s=0,l=e.selectedCards.length-1;l>=0;l-=1)s+=e.selectedCards[l].pay;e.total=Math.round(100*s)/100,e.checkout=function(){var e=btoa(window.location.origin+"/checkout"),t="/login/#/?forward_url="+e;a.get("user")?window.location="/checkout":swal({title:"Notice",text:'You can login before going to the next step <a href="'+t+'">LOGIN NOW</a>  </br> Or you can continue to use the site as a guest',type:"warning",showCancelButton:!0,confirmButtonText:"Continue as guest",closeOnConfirm:!1,confirmButtonColor:"#08C",html:!0},function(){window.location=window.location.origin+"/checkout/#/?guest=true",swal.close()})},e.removeCard=function(t){var r=a.get("cart");r.splice(t,1),a.set("cart",r),e.selectedCards=a.get("cart"),e.total=n(e.selectedCards),i.$broadcast("CHANGE_CART")}}])}},{}],44:[function(e,t,r){"use strict";t.exports=function(e){e.controller("StoreDetailController",["$scope","$routeParams","$location","authService","userService","SweetAlert","store","storeService","$rootScope","cardList",function(e,t,r,o,a,i,n,s,l,c){e.oneAtATime=!1,e.storeName=t.id,e.priceRange={from:0,to:20},e.cards=c;var d,u;e.cards.length>0?(d=1e10,u=0):(d=0,u=100),angular.forEach(e.cards,function(e){d>e.value&&(d=e.value),u<e.value&&(u=e.value)});var f=parseInt(d),g=parseInt(u);f===g&&(g=f+1),e.priceRange={from:f,to:g},e.maxPrice=g,e.minPrice=f,console.log("max value",e.maxPrice),console.log("min value",e.minPrice);var p=n.get("cart");if(null!==p)for(var h=0;h<e.cards.length;h+=1)for(var m=0;m<p.length;m+=1)console.log(e.cards[h].id,p[m].id),e.cards[h].id===p[m].id&&(e.cards[h].isAdded=!0);e.addToCart=function(t,r){console.log("Add new item to cart",t);var o=n.get("cart");if(o){for(var a=!1,i=o.length-1;i>=0;i-=1)o[i].id===t.id&&(a=!0);a===!1&&(e.cards[r].isAdded=!0,o.push(angular.copy(t)),n.set("cart",o),l.$broadcast("CHANGE_CART",t))}else n.set("cart",[angular.copy(t)]),l.$broadcast("CHANGE_CART",t);var s=$(".shopping-cart"),c="animated tada",d=$("img.card_"+t.id);if(s.removeClass(c),d){var u=d.clone().offset({top:d.offset().top,left:d.offset().left}).css({opacity:"0.5",position:"absolute",height:"60px",width:"100px","z-index":"2000"}).appendTo($("body")).animate({top:s.offset().top+10,left:s.offset().left+10,width:50,height:30},1e3,"easeInOutExpo");setTimeout(function(){s.addClass(c)},1500),u.animate({width:0,height:0},function(){$(this).detach()})}}}])}},{}],45:[function(e,t,r){"use strict";t.exports=function(e){e.controller("StoreListController",["$scope","$location","$routeParams","authService","storeService","storeList",function(e,t,r,o,a,i){e.oneAtATime=!1,e.bCount=0,e.cCount=0,e.eCount=0,e.fCount=0,e.hCount=0,e.totalStores=0,e.stores=i;var n=100,s=0;angular.forEach(e.stores,function(t){"B"===t.category&&(e.bCount+=1),"C"===t.category&&(e.cCount+=1),"E"===t.category&&(e.eCount+=1),"F"===t.category&&(e.fCount+=1),"H"===t.category&&(e.hCount+=1),n>t.discount&&(n=t.discount),s<t.discount&&(s=t.discount)}),e.totalStores=e.stores;var l=parseInt(n),c=parseInt(s);e.discount={from:l,to:c},e.minDiscount=l,e.maxDiscount=c,e.categoryIncludes=[],e.includeCategory=function(t){var r=$.inArray(t,e.categoryIncludes);r>-1?e.categoryIncludes.splice(r,1):e.categoryIncludes.push(t)},e.categoryFilter=function(t){return e.categoryIncludes.length>0&&$.inArray(t.category,e.categoryIncludes)<0?void 0:t}}])}},{}],46:[function(e,t,r){"use strict";var o=angular.module("ht.directives",[]);e("./lib/route-loader")(o),t.exports=o},{"./lib/route-loader":47}],47:[function(e,t,r){"use strict";t.exports=function(e){e.directive("routeLoader",function(){return{restrict:"EA",link:function(e,t){function r(){t.css("display","none")}var o=t.css("display");e.$on("$routeChangeStart",function(){t.css("display",o)}),e.$on("$routeChangeSuccess",r),e.$on("$routeChangeError",r),r()}}})}},{}],48:[function(e,t,r){"use strict";var o=angular.module("ht.filters",[]);e("./lib/title-case")(o),e("./lib/discount")(o),e("./lib/value")(o),t.exports=o},{"./lib/discount":49,"./lib/title-case":50,"./lib/value":51}],49:[function(e,t,r){"use strict";t.exports=function(e){e.filter("discount",function(){return function(e,t,r){for(var o=[],a=0;a<e.length;a+=1){var i=e[a];t<=i.discount&&i.discount<=r&&o.push(i)}return o}})}},{}],50:[function(e,t,r){"use strict";t.exports=function(e){e.filter("titlecase",function(){return function(e){var t=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;return e=e.toLowerCase(),e.replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(e,r,o){return r>0&&r+e.length!==o.length&&e.search(t)>-1&&":"!==o.charAt(r-2)&&(" - "!==o.charAt(r+e.length)||" - "===o.charAt(r-1))&&o.charAt(r-1).search(/[^\s-]/)<0?e.toLowerCase():e.substr(1).search(/[A-Z]|\../)>-1?e:e.charAt(0).toUpperCase()+e.substr(1)})}}).filter("storename",function(){return function(e){return void 0!==e?e.split("-").join(" "):""}}).filter("fullname",function(){return function(e){return void 0!==e.first_name&&void 0!==e.last_name?e.first_name+" "+e.last_name:e.email}}).filter("dashboardProfile",function(){return function(e){return"/dashboard/#/user-profile/"+e.id}}).filter("dashboardDealerProfile",function(){return function(e){return"/dashboard/#/dealer-profile/"+e.id}}).filter("hiddenCC",function(){return function(e){if(e){for(var t=e.split(""),r=[],o=0;o<t.length;o+=1)r.push(o>t.length-1-4&&o<t.length?t[o]:"*");return r.join("")}return"NOT SET"}})}},{}],51:[function(e,t,r){"use strict";t.exports=function(e){e.filter("cardvalue",function(){return function(e,t,r){for(var o=[],a=0;a<e.length;a+=1){var i=e[a];t<=i.value&&i.value<=r&&o.push(i)}return o}})}},{}],52:[function(e,t,r){"use strict";var o=angular.module("ht.services",[]);e("./lib/store")(o),e("./lib/user")(o),e("./lib/auth")(o),e("./lib/order")(o),e("./lib/receipts")(o),e("./lib/selling_cards")(o),e("./lib/utils")(o),e("./lib/setting")(o),e("./lib/card")(o),e("./lib/transactions")(o),t.exports=o},{"./lib/auth":53,"./lib/card":54,"./lib/order":55,"./lib/receipts":56,"./lib/selling_cards":57,"./lib/setting":58,"./lib/store":59,"./lib/transactions":60,"./lib/user":61,"./lib/utils":62}],53:[function(e,t,r){"use strict";t.exports=function(e){e.factory("authService",["store","$location","userService","$modal","$http",function(e,t,r,o,a){var i=function(e){},n=function(e){},s=function(){},l=function(){return console.log("CURRENT LOGGINED USER",e.get("user")),e.get("admin")?!0:(window.location="/admin-login/#/",!1)},c=function(){return console.log("CURRENT LOGGINED USER",e.get("user")),e.get("user")?!0:!1};return{login:i,logout:n,auth:s,adminAuthenticate:l,isAuthenticated:c}}])}},{}],54:[function(e,t,r){"use strict";t.exports=function(e){e.factory("cardService",["$resource",function(e){return e("/api/cards/:id",null,{inquiry:{method:"POST",url:"/api/cards/inquiry"}})}])}},{}],55:[function(e,t,r){"use strict";t.exports=function(e){e.factory("orderService",["$resource",function(e){return e("/api/orders/:id",null,{get:{method:"GET",url:"/api/orders/:id"},query:{method:"GET",isArray:!0,url:"/api/orders"},sendGiftCards:{method:"GET",url:"/api/orders/giftcards/:id"}})}])}},{}],56:[function(e,t,r){"use strict";t.exports=function(e){e.factory("receiptService",["$resource",function(e){return e("/api/receipts/:id",null,{get:{method:"GET",url:"/api/receipts/:id"},putToInventory:{method:"GET",url:"/api/receipts/put-to-inventory/:id"}})}])}},{}],57:[function(e,t,r){"use strict";t.exports=function(e){e.factory("sellingCardsService",["$resource",function(e){return e("/api/selling_cards/:id",null,{get:{method:"GET",url:"/api/selling_cards/:id"},putToInventory:{method:"GET",url:"/api/selling_cards/put-to-inventory/:cardId/:storeId"}})}])}},{}],58:[function(e,t,r){"use strict";t.exports=function(e){e.factory("settingService",["$resource",function(e){return e("/api/settings/:id",null,{get:{method:"GET",url:"/api/settings/:id"},query:{method:"GET",isArray:!0,url:"/api/settings"},update:{method:"PUT"}})}])}},{}],59:[function(e,t,r){"use strict";t.exports=function(e){e.factory("storeService",["$resource",function(e){return e("/api/stores/:id",null,{update:{method:"PUT"},featured:{method:"GET",url:"/api/stores/featured",isArray:!0},highestPayout:{method:"GET",url:"/api/stores/highest-payout",isArray:!0},get:{method:"GET",url:"/api/stores/:id",isArray:!0},stats:{method:"GET",url:"/api/stores/stats"},popularBought:{method:"GET",url:"/api/stores/popular-bought",isArray:!0},popularSold:{method:"GET",url:"/api/stores/popular-sold",isArray:!0},average:{method:"GET",url:"/api/stores/average"},dateRanges:{method:"GET",url:"/api/stores/date-ranges"},limits:{method:"GET",url:"/api/stores/limits",isArray:!0}})}])}},{}],60:[function(e,t,r){"use strict";t.exports=function(e){e.factory("transactionService",["$resource",function(e){return e("/api/transactions/:id",null,{})}])}},{}],61:[function(e,t,r){"use strict";t.exports=function(e){e.factory("userService",["$resource",function(e){return e("/api/users/:id",null,{update:{method:"PUT"},login:{method:"POST",url:"/api/users/login"},adminLogin:{method:"POST",url:"/api/users/admin-login"},get:{method:"GET"},dealers:{method:"GET",url:"/api/users/dealers",isArray:!0},profile:{method:"GET",url:"/api/users/profile/:id"},guestsSellingCards:{method:"GET",url:"/api/users/guests/sell_cards",isArray:!0},guestsBuyingCards:{method:"GET",url:"/api/users/guests/buy_cards",isArray:!0},inventory:{method:"GET",url:"/api/users/inventory",isArray:!0},inventoryByRetailer:{method:"GET",url:"/api/users/inventory_by_retailer",isArray:!0},cards:{method:"GET",url:"/api/users/cards",isArray:!0},soldCards:{method:"GET",url:"/api/users/sold-cards",isArray:!0},pendingCards:{method:"GET",url:"/api/users/pending-cards",isArray:!0},forgetPassword:{method:"POST",url:"/api/users/forget-password"},resetPassword:{method:"POST",url:"/api/users/reset-password"},pay:{method:"POST",url:"/api/users/pay-order"},sellCards:{method:"POST",url:"/api/users/sell-cards"},getOrdersByUserId:{method:"GET",url:"/api/users/orders/:id",isArray:!0},getSoldCardsByUserId:{method:"GET",url:"/api/users/sold-cards-list/:id",isArray:!0}})}])}},{}],62:[function(e,t,r){"use strict";t.exports=function(e){e.factory("utilService",["$resource",function(){var e=function(e){for(var t=0,r=0;r<e.length;r+=1)t+=e[r].gogo_buy*e[r].value*e[r].amount/100;return t},t=function(e){for(var t=0,r=0;r<e.length;r+=1){var o=e[r].gogo_buy*e[r].value*e[r].amount/100;t+=o}return.9425*t},r=function(e){for(var t=0,r=0;r<e.length;r+=1)t+=e[r].value;return t},o=function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},a=function(e){for(var t=0,r=0;r<e.length;r+=1)t+=e[r].gogo_buy;return t/e.length};return{totalOfferMailCard:e,totalOfferOnline:t,titleCase:o,totalFaceValue:r,averagePayout:a}}])}},{}]},{},[1]);